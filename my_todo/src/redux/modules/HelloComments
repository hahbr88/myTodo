import { createAsyncThunk, createSlice } from "@reduxjs/toolkit";
import axios from "axios";

export const fetchCommet = createAsyncThunk("comments/fetchCommet", async () => {
  
  return await axios
    .get("http://localhost:3001/comments")
    .then((res) => res.data)
    .catch((error) => error);

});
console.log(fetchCommet);
const HelloComment = createSlice({
  name: "comments",
  initialState: {
    comments: [],
    loading: false,
    error: ""
  },
  reducers: {},
  extraReducers: {
    // createAsyncThunk 했을때 약속 
    // pendign : 비동기 작업을 시작했을때 상태
    [fetchCommet.pending]: (state) => {
      state.loading = true;
      state.comments = [];
      state.error = "";
    },
    // fulfilled : 비동기 작업이 끝났을때 상태(데이터를 자져왔을때)
    [fetchCommet.fulfilled]: (state, action) => {
      state.comments = action.payload;
      state.loading = false;
      state.error = "";
    },
    //rejected: 오류가 생겨서 중단 됐을때 
    [fetchCommet.rejected]: (state, action) => {
      state.loading = false;
      state.comments = [];
      state.error = action.payload;
    }
  }
});

export default HelloComment.reducer;